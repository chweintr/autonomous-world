/* Agent Worlds â€” Studio */
:root{
  --bg:#0f1115; --panel:#141821; --elev:#0c0f14; --text:#e6e6e6; --muted:#a7b0bd; --line:rgba(255,255,255,.08);
  --accent:#ffd44d; /* citrine */ --accent-2:#ff5c9a; /* poppy pink */ --accent-3:#6dd6ff; /* aqua */
  --ok:#6ee7b7; --danger:#f87171; --shadow:rgba(0,0,0,.4);
  --radius:14px; --radius-sm:10px; --gap:18px;
  --mono:"JetBrains Mono",ui-monospace,Menlo,Consolas,monospace;
  --sans:"Inter",system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  --serif:"Newsreader",ui-serif,Georgia,"Times New Roman",serif;
  --blur:saturate(1.1) blur(8px);
}
html[data-theme="sand"]{--bg:#11100e;--panel:#1a1916;--elev:#141310;--accent:#ffd089;--accent-2:#ff7aa2;--accent-3:#88e0ff;}
html[data-theme="aqua"]{--bg:#0d1014;--panel:#10161f;--elev:#0a1017;--accent:#62e0ff;--accent-2:#ff7aa2;--accent-3:#a7ff62;}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; color:var(--text); font-family:var(--sans); line-height:1.45; letter-spacing:.2px;
  background:
    radial-gradient(1200px 800px at 10% 10%,rgba(255,255,255,.06),transparent 50%),
    radial-gradient(1000px 600px at 90% 20%,rgba(255,255,255,.04),transparent 40%),
    var(--bg);
}

/* Topbar */
.topbar{position:sticky;top:0;z-index:40;display:flex;align-items:center;justify-content:space-between;
  padding:12px 18px;background:color-mix(in oklab,var(--panel),black 10%);border-bottom:1px solid var(--line);backdrop-filter:var(--blur)}
.brand{display:flex;align-items:baseline;gap:10px}
.brand .glyph{color:var(--accent-3);font-size:20px;line-height:1}
.brand .title{font-weight:800;letter-spacing:.5px;font-size:14px;text-transform:uppercase;color:#fafafa}
.toolbar{display:flex;gap:8px;align-items:center}
.fps{min-width:100px;font-family:var(--mono);font-size:12px;color:var(--muted);text-align:right}

/* Layout */
.layout{display:grid;grid-template-columns:300px minmax(680px,1.6fr) 420px;gap:var(--gap);padding:var(--gap);max-width:1800px;margin:0 auto}
.panel{
  background:linear-gradient(180deg,color-mix(in oklab,var(--panel),#000 5%),color-mix(in oklab,var(--panel),#000 12%));
  border:1px solid var(--line); border-radius:var(--radius); box-shadow:0 10px 30px var(--shadow); overflow:hidden; min-height:320px;
}
.section{padding:18px 18px 8px 18px}
.section-tight{padding-top:8px}
.section h2,.section h3,.section h4{margin:0 0 12px 0;font-weight:700;letter-spacing:.3px;color:#fff}
.section h2{font-size:18px}.section h3{font-size:16px;color:var(--muted)}.section h4{font-size:14px;color:var(--muted)}

/* Forms */
.form{display:grid;grid-template-columns:1fr 1.2fr;gap:10px 12px;align-items:center}
.param-grid{display:grid;grid-template-columns:1fr 1.2fr;gap:10px 12px;margin-bottom:14px}
label{font-size:12px;color:var(--muted);font-weight:500}
select,input[type="text"],input[type="number"],input[type="password"]{
  font:inherit;font-size:13px;background:var(--elev);color:var(--text);border:1px solid var(--line);
  border-radius:10px;padding:8px 10px;outline:none;
}
select:focus,input:focus{border-color:color-mix(in oklab,var(--accent),#fff 10%)}
.check{display:flex;align-items:center;gap:8px;margin-bottom:10px}
.check input{width:18px;height:18px;accent-color:var(--accent)}
.check span{font-size:13px}
.hidden{display:none}
.btn-row{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-top:12px}
.btn{border:1px solid var(--line);border-radius:12px;background:var(--elev);color:var(--text);padding:10px 12px;font-weight:600;cursor:pointer;transition:transform .08s ease,border-color .2s ease;font-size:13px}
.btn:hover{border-color:color-mix(in oklab,var(--accent),white 10%)} .btn:active{transform:translateY(1px)}
.btn.primary{background:linear-gradient(180deg,color-mix(in oklab,var(--accent),#000 60%),color-mix(in oklab,var(--accent),#000 80%));color:#0b0c0f;border-color:var(--accent)}
.btn.ghost{background:transparent} .btn.small{padding:6px 10px;font-size:12px}

/* Status */
.status .kv{display:flex;gap:8px;align-items:baseline;margin:4px 0;font-size:13px}
.status .kv span{color:var(--muted)}
.status .kv strong{color:var(--text)}
.states{margin:8px 0 10px 0;padding-left:18px;color:var(--muted);font-size:12px} .states li{margin:2px 0}

/* Notes */
.notes{display:flex;flex-direction:column}
.scene-bar{position:sticky;top:0;z-index:5;display:flex;justify-content:space-between;align-items:center;
  padding:16px 18px 0 18px;background:linear-gradient(180deg,rgba(20,24,33,.95),rgba(20,24,33,.75));
  backdrop-filter:var(--blur);border-bottom:1px solid var(--line);margin-bottom:10px;padding-bottom:12px}
.scene-label{font-weight:800;letter-spacing:.5px;color:#fff;text-transform:uppercase;font-size:14px}
.meta-row{display:flex;gap:8px;align-items:center;margin-top:6px}
.chip{display:inline-flex;align-items:center;gap:8px;padding:4px 10px;border-radius:20px;background:color-mix(in oklab,var(--accent-3),#000 85%);color:color-mix(in oklab,var(--accent-3),white 30%);font-size:11px;border:1px solid var(--line);font-weight:600}
.chip.temp{background:color-mix(in oklab,var(--accent-2),#000 85%);color:color-mix(in oklab,var(--accent-2),white 30%)}
.chip.emergent{background:color-mix(in oklab,var(--accent),#000 85%);color:color-mix(in oklab,var(--accent),white 30%)}

.notes-feed{list-style:none;margin:0;padding:8px 18px 18px 18px;display:grid;gap:14px;overflow:auto;max-height:calc(100vh - 220px)}
.note{
  position:relative;background:color-mix(in oklab,var(--panel),black 5%);border:1px solid var(--line);border-radius:var(--radius-sm);
  padding:14px 14px 12px 14px;box-shadow:inset 0 1px 0 rgba(255,255,255,.02),0 10px 20px var(--shadow);
  border-left:3px solid color-mix(in oklab,var(--accent),#000 30%);
}
.note::after{content:"";position:absolute;inset:0;border-radius:inherit;background:repeating-linear-gradient(0deg,transparent 0 2px,rgba(255,255,255,.015) 2px 3px);pointer-events:none}
.note-head{display:flex;align-items:center;gap:10px;margin-bottom:8px;font-family:var(--mono)}
.timestamp{color:var(--muted);font-size:12px;font-variant-numeric:tabular-nums}
.pill{padding:2px 8px;border-radius:999px;border:1px solid var(--line);color:var(--muted);font-size:11px}
.note-body{margin:6px 0 10px 0;font-family:var(--serif);font-size:17px;line-height:1.65;letter-spacing:.005em;text-wrap:pretty;-webkit-font-smoothing:antialiased}
.aside{display:grid;grid-template-columns:auto 1fr;gap:8px;align-items:baseline;margin-top:10px}
.tag{font-family:var(--mono);font-size:11px;color:var(--accent);letter-spacing:.4px}
.muted{color:var(--muted);font-size:14px;line-height:1.5}
.temp-line{display:flex;align-items:center;gap:10px;margin-top:12px;color:var(--muted);font-size:13px}
.temp-line strong{color:#fff}
.temp-line::before{content:"";width:90px;height:6px;border-radius:999px;opacity:.55;background:linear-gradient(90deg,#6ee7b7,#ffd44d,#f87171)}
.temp-line.calm strong{color:var(--ok)} .temp-line.calm::before{background:linear-gradient(90deg,#6ee7b7,#9ff4cf)}
.temp-line.uncertain strong{color:var(--accent-3)} .temp-line.uncertain::before{background:linear-gradient(90deg,#6dd6ff,#ffd44d)}
.temp-line.tense strong{color:var(--danger)} .temp-line.tense::before{background:linear-gradient(90deg,#f87171,#ff9aa2)}
.temp-line.charged strong{color:var(--accent)} .temp-line.charged::before{background:linear-gradient(90deg,#ffd44d,#ffb84d)}

/* Paintable Moments */
.paintable-moment{
  background:color-mix(in oklab,var(--elev),#000 10%);border:1px solid var(--line);border-radius:var(--radius-sm);
  padding:14px;margin-bottom:12px;border-left:3px solid var(--accent-2);
}
.paintable-header{font-weight:700;margin-bottom:10px;font-size:13px;color:var(--accent-2)}
.paintable-section{margin:8px 0;font-size:13px}
.paintable-section strong{display:block;font-family:var(--mono);font-size:11px;color:var(--accent);margin-bottom:4px;letter-spacing:.5px}
.paintable-prompt{background:var(--panel);padding:10px;border-left:2px solid var(--accent-3);margin:8px 0;font-family:var(--serif);font-size:14px;line-height:1.6}

/* Report */
.report .section-head{display:flex;justify-content:space-between;align-items:center}
.report-body{padding:0 18px 18px 18px}
.report pre{background:var(--elev);border:1px solid var(--line);border-radius:var(--radius-sm);padding:14px;margin:0;font-family:var(--mono);font-size:12.5px;color:color-mix(in oklab,var(--text),#fff 10%);max-height:400px;overflow:auto;line-height:1.6}

/* Toast */
.toast{position:fixed;bottom:18px;left:50%;transform:translateX(-50%);background:color-mix(in oklab,var(--panel),black 5%);border:1px solid var(--line);padding:10px 14px;border-radius:12px;color:var(--text);font-weight:600;opacity:0;pointer-events:none;transition:opacity .2s ease,transform .2s ease;box-shadow:0 10px 30px var(--shadow);font-size:13px}
.toast.show{opacity:1;transform:translateX(-50%) translateY(-2px)}

:focus-visible{outline:2px solid color-mix(in oklab,var(--accent),white 10%);outline-offset:2px;border-radius:8px}
hr{border:none;border-top:1px solid var(--line);margin:8px 0}
.sr-only{position:absolute!important;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

/* Responsive */
@media (max-width:1200px){.layout{grid-template-columns:300px 1fr} #reportPanel{display:none}}
@media (max-width:860px){.layout{grid-template-columns:1fr} #controls{order:2} #reportPanel{display:block;order:3} .notes-feed{max-height:none}}
@media (prefers-reduced-motion:reduce){*{scroll-behavior:auto} .toast{transition:none}}


